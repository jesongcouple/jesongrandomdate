<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<meta name="theme-color" content="#ff4d6d" />
<link rel="manifest" href="./manifest.webmanifest" />
<link rel="apple-touch-icon" href="./icons/apple-touch-icon.png" />
<title>Ï†ú‚Ä¢ÏÜ° 5Ï£ºÎÖÑ ÎûúÎç§Îç∞Ïù¥Ìä∏</title>
<style>
:root{--main:#ff4d6d;--bg:#fff0f3;--ink:#c9184a;}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;font-family:-apple-system,system-ui,sans-serif;}
body{margin:0;background:var(--bg);}
.wrap{max-width:520px;margin:0 auto;padding:14px;}
.card{background:#fff;border:6px solid #ffccd5;border-radius:28px;padding:14px;box-shadow:0 14px 30px rgba(255,77,109,.18);}
.title{font-weight:900;color:var(--ink);font-size:20px;margin:0 0 14px;text-align:center;}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
input{flex:1;min-width:180px;padding:12px 14px;border-radius:18px;border:3px solid #ffccd5;font-size:16px;outline:none;text-align:center;}
button{padding:12px 16px;border:0;border-radius:999px;background:linear-gradient(135deg,#ff4d6d,#ff85a2);color:#fff;font-weight:900;font-size:16px;box-shadow:0 10px 18px rgba(255,77,109,.25);cursor:pointer;}
button:disabled{background:#ccc;box-shadow:none;cursor:default;}
.stageWrap{margin-top:12px;background:#fff8f9;border:3px solid #ffb3c1;border-radius:22px;overflow:hidden;position:relative;}
.viewport{width:100%;height:72vh;overflow:auto;-webkit-overflow-scrolling:touch;background:#fff8f9;position:relative; touch-action:none;}
.viewport{scrollbar-width:none;-ms-overflow-style:none;}
.viewport::-webkit-scrollbar{width:0;height:0;display:none;}

svg{display:block;}
.lineStroke{stroke-width:22;stroke-linecap:round;stroke-linejoin:round;fill:none;opacity:.95;filter:drop-shadow(0 10px 14px rgba(0,0,0,.10));}
.lineInner{stroke:#fff;stroke-width:7;stroke-linecap:round;stroke-linejoin:round;fill:none;opacity:.95;}
.connector{stroke:#ffb3c1;stroke-width:5;stroke-linecap:round;opacity:.75;fill:none;}
.label{font-size:12px;font-weight:900;fill:#c9184a;opacity:1;}
.stationDot{fill:#fff;stroke:var(--main);stroke-width:4;opacity:1;}
.token{filter:drop-shadow(0 10px 12px rgba(0,0,0,.16));}
.token circle,.token rect{fill:var(--main);stroke:#fff;stroke-width:4;}
#hudRect{fill:white;stroke:#ffccd5;stroke-width:4;opacity:.94;}
#confetti{position:absolute;inset:0;pointer-events:none;z-index:20;}

#resultOverlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;}
#resultBackdrop{position:absolute;inset:0;background:rgba(255,240,243,.55);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);}
#resultBox{position:relative;width:min(360px,86vw);background:#fff;border-radius:24px;padding:22px 26px;text-align:center;border:4px solid #ffccd5;box-shadow:0 20px 40px rgba(255,77,109,.25);overflow:hidden;}
#resultCanvas{position:absolute;inset:0;pointer-events:none;z-index:2;}
#resultContent{position:relative;z-index:3;}
#err{position:fixed;left:12px;right:12px;bottom:12px;z-index:99999;display:none;background:rgba(0,0,0,.85);color:#fff;padding:12px 14px;border-radius:14px;font-weight:900;font-size:12px;line-height:1.35;}
</style>
</head>
<body>
<div id="err"></div>
<div class="wrap">
  <div class="card">
    <div class="title">Ï†ú‚Ä¢ÏÜ° 5Ï£ºÎÖÑ ÎûúÎç§Îç∞Ïù¥Ìä∏</div>
    <div class="row">
      <input id="startInput" placeholder="Ï∂úÎ∞úÏó≠ (Ïòà: ÌôîÏ†ï, Í∞ïÎÇ®, ÌôçÎåÄÏûÖÍµ¨)" />
      <button id="goBtn" type="button">Ï∂úÎ∞ú üé≤</button>
    </div>
    <div class="stageWrap">
      <div class="viewport" id="viewport">
        <svg id="map" width="2600" height="1400" viewBox="0 0 2600 1400" aria-label="ÎÑ§Ìä∏ÏõåÌÅ¨ Îßµ">
          <g id="gLines"></g>
          <g id="gDots"></g>
          <g id="token" class="token" transform="translate(100,100)">
            <circle cx="0" cy="-18" r="10"></circle>
            <rect x="-10" y="-6" width="20" height="26" rx="10"></rect>
          </g>
          <g id="hudG" style="pointer-events:none;">
            <rect id="hudRect" x="-120" y="-92" width="240" height="62" rx="16"></rect>
            <text id="hudLine1" x="0" y="-64" text-anchor="middle" font-size="13" font-weight="900" fill="#c9184a">-</text>
            <text id="hudLine2" x="0" y="-44" text-anchor="middle" font-size="12" font-weight="900" fill="#ff4d6d">Ïù¥Îèô: 0Ï†ïÍ±∞Ïû•</text>
          </g>
        </svg>
        <canvas id="confetti"></canvas>
      </div>
    </div>
  </div>
</div>

<div id="resultOverlay">
  <div id="resultBackdrop"></div>
  <div id="resultBox">
    <canvas id="resultCanvas"></canvas>
    <div id="resultContent">
      <div style="font-size:13px;font-weight:900;color:#777;">ÏµúÏ¢Ö ÎèÑÏ∞©</div>
      <div id="resultStation" style="margin-top:6px;font-size:26px;font-weight:900;color:#c9184a;"></div>
      <div id="resultCount" style="margin-top:10px;font-size:15px;font-weight:900;color:#ff4d6d;"></div>
      <button id="closeBtn" style="margin-top:14px;padding:10px 16px;border-radius:999px;border:none;background:linear-gradient(135deg,#ff4d6d,#ff85a2);color:white;font-weight:900;font-size:14px;cursor:pointer;">ÌôïÏù∏ ‚ù§Ô∏è</button>
    </div>
  </div>
</div>

<script>
function sleep(ms){ return new Promise(res=>setTimeout(res, ms)); }

function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min; }

(function(){
  const errEl=document.getElementById('err');
  function showErr(msg){ errEl.textContent=msg; errEl.style.display='block'; }
  window.addEventListener('error',(e)=>showErr('JS ÏóêÎü¨: '+(e.message||'unknown')));
  window.addEventListener('unhandledrejection',(e)=>showErr('Promise ÏóêÎü¨: '+(e.reason?.message||e.reason||'unknown')));

  const DATA = {"1Ìò∏ÏÑ†":["Ïó∞Ï≤ú","Ï†ÑÍ≥°","Ï≤≠ÏÇ∞","ÏÜåÏöîÏÇ∞","ÎèôÎëêÏ≤ú","ÏßÄÌñâ","ÎçïÏ†ï","ÎçïÍ≥Ñ","ÏñëÏ£º","ÎÖπÏñë","Í∞ÄÎä•","ÏùòÏ†ïÎ∂Ä","ÌöåÎ£°","ÎßùÏõîÏÇ¨","ÎèÑÎ¥âÏÇ∞","ÎèÑÎ¥â","Î∞©Ìïô","Ï∞ΩÎèô","ÎÖπÏ≤ú","ÏõîÍ≥Ñ","Í¥ëÏö¥ÎåÄ","ÏÑùÍ≥Ñ","Ïã†Ïù¥Î¨∏","Ïô∏ÎåÄÏïû","ÌöåÍ∏∞","Ï≤≠ÎüâÎ¶¨","Ï†úÍ∏∞Îèô","Ïã†ÏÑ§Îèô","ÎèôÎ¨òÏïû","ÎèôÎåÄÎ¨∏","Ï¢ÖÎ°ú5Í∞Ä","Ï¢ÖÎ°ú3Í∞Ä","Ï¢ÖÍ∞Å","ÏãúÏ≤≠","ÏÑúÏö∏Ïó≠","ÎÇ®ÏòÅ","Ïö©ÏÇ∞","ÎÖ∏ÎüâÏßÑ","ÎåÄÎ∞©","Ïã†Í∏∏","ÏòÅÎì±Ìè¨","Ïã†ÎèÑÎ¶º","Íµ¨Î°ú","Íµ¨Ïùº","Í∞úÎ¥â","Ïò§Î•òÎèô","Ïò®Ïàò","Ïó≠Í≥°","ÏÜåÏÇ¨","Î∂ÄÏ≤ú","Ï§ëÎèô","ÏÉÅÎèô","ÏÜ°ÎÇ¥","Î∂ÄÍ∞ú","Î∂ÄÌèâ","Î∞±Ïö¥","ÎèôÏïî","Í∞ÑÏÑù","Ï£ºÏïà","ÎèÑÌôî","Ï†úÎ¨ºÌè¨","ÎèÑÏõê","ÎèôÏù∏Ï≤ú","Ïù∏Ï≤ú","Í∞ÄÏÇ∞ÎîîÏßÄÌÑ∏Îã®ÏßÄ","ÎèÖÏÇ∞","Í∏àÏ≤úÍµ¨Ï≤≠","ÏÑùÏàò","Í¥ÄÏïÖ","ÏïàÏñë","Î™ÖÌïô","Í∏àÏ†ï","ÏÇ∞Î≥∏","ÏàòÎ¶¨ÏÇ∞","ÎåÄÏïºÎØ∏","Î∞òÏõî","ÏÉÅÎ°ùÏàò","ÌïúÎåÄÏïû","Ï§ëÏïô","Í≥†Ïûî","Ï¥àÏßÄ","ÏïàÏÇ∞","Ïã†Í∏∏Ïò®Ï≤ú","Ï†ïÏôï","Ïò§Ïù¥ÎèÑ","ÏùòÏôï","ÏÑ±Í∑†Í¥ÄÎåÄ","ÌôîÏÑú","ÏàòÏõê","ÏÑ∏Î•ò","Î≥ëÏ†ê","ÏÑ∏Îßà","Ïò§ÏÇ∞ÎåÄ","Ïò§ÏÇ∞","ÏßÑÏúÑ","ÏÜ°ÌÉÑ","ÏÑúÏ†ïÎ¶¨","ÌèâÌÉùÏßÄÏ†ú","ÌèâÌÉù","ÏÑ±Ìôò","ÏßÅÏÇ∞","ÎëêÏ†ï","Ï≤úÏïà","Î¥âÎ™Ö","ÏåçÏö©","ÏïÑÏÇ∞","ÌÉïÏ†ï","Î∞∞Î∞©","Ïò®ÏñëÏò®Ï≤ú","Ïã†Ï∞Ω"],"2Ìò∏ÏÑ†":["ÏãúÏ≤≠","ÏùÑÏßÄÎ°úÏûÖÍµ¨","ÏùÑÏßÄÎ°ú3Í∞Ä","ÏùÑÏßÄÎ°ú4Í∞Ä","ÎèôÎåÄÎ¨∏Ïó≠ÏÇ¨Î¨∏ÌôîÍ≥µÏõê","Ïã†Îãπ","ÏÉÅÏôïÏã≠Î¶¨","ÏôïÏã≠Î¶¨","ÌïúÏñëÎåÄ","ÎöùÏÑ¨","ÏÑ±Ïàò","Í±¥ÎåÄÏûÖÍµ¨","Íµ¨Ïùò","Í∞ïÎ≥Ä","Ïû†Ïã§ÎÇòÎ£®","Ïû†Ïã§","Ïû†Ïã§ÏÉàÎÇ¥","Ï¢ÖÌï©Ïö¥ÎèôÏû•","ÏÇºÏÑ±","ÏÑ†Î¶â","Ïó≠ÏÇº","Í∞ïÎÇ®","ÍµêÎåÄ","ÏÑúÏ¥à","Î∞©Î∞∞","ÏÇ¨Îãπ","ÎÇôÏÑ±ÎåÄ","ÏÑúÏö∏ÎåÄÏûÖÍµ¨","Î¥âÏ≤ú","Ïã†Î¶º","Ïã†ÎåÄÎ∞©","Íµ¨Î°úÎîîÏßÄÌÑ∏Îã®ÏßÄ","ÎåÄÎ¶º","Ïã†ÎèÑÎ¶º","Î¨∏Îûò","ÏòÅÎì±Ìè¨Íµ¨Ï≤≠","ÎãπÏÇ∞","Ìï©Ï†ï","ÌôçÎåÄÏûÖÍµ¨","Ïã†Ï¥å","Ïù¥ÎåÄ","ÏïÑÌòÑ","Ï∂©Ï†ïÎ°ú","Ïö©Îãµ","Ïã†Îãµ","Ïö©Îëê","Ïã†ÏÑ§Îèô","ÎèÑÎ¶ºÏ≤ú","ÏñëÏ≤úÍµ¨Ï≤≠","Ïã†Ï†ïÎÑ§Í±∞Î¶¨","ÍπåÏπòÏÇ∞"],"3Ìò∏ÏÑ†":["ÎåÄÌôî","Ï£ºÏóΩ","Ï†ïÎ∞úÏÇ∞","ÎßàÎëê","Î∞±ÏÑù","ÎåÄÍ≥°","ÌôîÏ†ï","ÏõêÎãπ","ÏõêÌù•","ÏÇºÏÜ°","ÏßÄÏ∂ï","Íµ¨ÌååÎ∞ú","Ïó∞Ïã†ÎÇ¥","Î∂àÍ¥ë","ÎÖπÎ≤à","ÌôçÏ†ú","Î¨¥ÏïÖÏû¨","ÎèÖÎ¶ΩÎ¨∏","Í≤ΩÎ≥µÍ∂Å","ÏïàÍµ≠","Ï¢ÖÎ°ú3Í∞Ä","ÏùÑÏßÄÎ°ú3Í∞Ä","Ï∂©Î¨¥Î°ú","ÎèôÎåÄÏûÖÍµ¨","ÏïΩÏàò","Í∏àÌò∏","Ïò•Ïàò","ÏïïÍµ¨Ï†ï","Ïã†ÏÇ¨","Ïû†Ïõê","Í≥†ÏÜçÌÑ∞ÎØ∏ÎÑê","ÍµêÎåÄ","ÎÇ®Î∂ÄÌÑ∞ÎØ∏ÎÑê","ÏñëÏû¨","Îß§Î¥â","ÎèÑÍ≥°","ÎåÄÏπò","ÌïôÏó¨Ïö∏","ÎåÄÏ≤≠","ÏùºÏõê","ÏàòÏÑú","Í∞ÄÎùΩÏãúÏû•","Í≤ΩÏ∞∞Î≥ëÏõê","Ïò§Í∏à"],"4Ìò∏ÏÑ†":["ÏßÑÏ†ë","Ïò§ÎÇ®","Î≥ÑÎÇ¥Î≥ÑÍ∞ÄÎûå","ÎãπÍ≥†Í∞ú","ÏÉÅÍ≥Ñ","ÎÖ∏Ïõê","Ï∞ΩÎèô","ÏåçÎ¨∏","ÏàòÏú†","ÎØ∏ÏïÑ","ÎØ∏ÏïÑÏÇ¨Í±∞Î¶¨","Í∏∏Ïùå","ÏÑ±Ïã†Ïó¨ÎåÄÏûÖÍµ¨","ÌïúÏÑ±ÎåÄÏûÖÍµ¨","ÌòúÌôî","ÎèôÎåÄÎ¨∏","ÎèôÎåÄÎ¨∏Ïó≠ÏÇ¨Î¨∏ÌôîÍ≥µÏõê","Ï∂©Î¨¥Î°ú","Î™ÖÎèô","ÌöåÌòÑ","ÏÑúÏö∏Ïó≠","ÏàôÎåÄÏûÖÍµ¨","ÏÇºÍ∞ÅÏßÄ","Ïã†Ïö©ÏÇ∞","Ïù¥Ï¥å","ÎèôÏûë","Ï¥ùÏã†ÎåÄÏûÖÍµ¨","ÏÇ¨Îãπ","ÎÇ®ÌÉúÎ†π","ÏÑ†Î∞îÏúÑ","Í≤ΩÎßàÍ≥µÏõê","ÎåÄÍ≥µÏõê","Í≥ºÏ≤ú","Ï†ïÎ∂ÄÍ≥ºÏ≤úÏ≤≠ÏÇ¨","Ïù∏ÎçïÏõê","ÌèâÏ¥å","Î≤îÍ≥Ñ","Í∏àÏ†ï","ÏÇ∞Î≥∏","ÏàòÎ¶¨ÏÇ∞","ÎåÄÏïºÎØ∏","Î∞òÏõî","ÏÉÅÎ°ùÏàò","ÌïúÎåÄÏïû","Ï§ëÏïô","Í≥†Ïûî","Ï¥àÏßÄ","ÏïàÏÇ∞","Ïã†Í∏∏Ïò®Ï≤ú","Ï†ïÏôï","Ïò§Ïù¥ÎèÑ"],"5Ìò∏ÏÑ†":["Î∞©Ìôî","Í∞úÌôîÏÇ∞","ÍπÄÌè¨Í≥µÌï≠","ÏÜ°Ï†ï","ÎßàÍ≥°","Î∞úÏÇ∞","Ïö∞Ïû•ÏÇ∞","ÌôîÍ≥°","ÍπåÏπòÏÇ∞","Ïã†Ï†ï","Î™©Îèô","Ïò§Î™©Íµê","ÏñëÌèâ","ÏòÅÎì±Ìè¨Íµ¨Ï≤≠","ÏòÅÎì±Ìè¨ÏãúÏû•","Ïã†Í∏∏","Ïó¨ÏùòÎèÑ","Ïó¨ÏùòÎÇòÎ£®","ÎßàÌè¨","Í≥µÎçï","Ïï†Ïò§Í∞ú","Ï∂©Ï†ïÎ°ú","ÏÑúÎåÄÎ¨∏","Í¥ëÌôîÎ¨∏","Ï¢ÖÎ°ú3Í∞Ä","ÏùÑÏßÄÎ°ú4Í∞Ä","ÎèôÎåÄÎ¨∏Ïó≠ÏÇ¨Î¨∏ÌôîÍ≥µÏõê","Ï≤≠Íµ¨","Ïã†Í∏àÌò∏","ÌñâÎãπ","ÏôïÏã≠Î¶¨","ÎßàÏû•","ÎãµÏã≠Î¶¨","Ïû•ÌïúÌèâ","Íµ∞Ïûê","ÏïÑÏ∞®ÏÇ∞","Í¥ëÎÇòÎ£®","Ï≤úÌò∏","Í∞ïÎèô","Í∏∏Îèô","ÍµΩÏùÄÎã§Î¶¨","Î™ÖÏùº","Í≥†Îçï","ÏÉÅÏùºÎèô","Í∞ïÏùº","ÎØ∏ÏÇ¨","ÌïòÎÇ®ÌíçÏÇ∞","ÌïòÎÇ®ÏãúÏ≤≠","ÌïòÎÇ®Í≤ÄÎã®ÏÇ∞","ÎëîÏ¥åÎèô","Ïò¨Î¶ºÌîΩÍ≥µÏõê","Î∞©Ïù¥","Ïò§Í∏à","Í∞úÎ°±","Í±∞Ïó¨","ÎßàÏ≤ú"],"6Ìò∏ÏÑ†":["ÏùëÏïî","Ïó≠Ï¥å","ÎèÖÎ∞îÏúÑ","Ïó∞Ïã†ÎÇ¥","Íµ¨ÏÇ∞","ÏÉàÏ†à","Ï¶ùÏÇ∞","ÎîîÏßÄÌÑ∏ÎØ∏ÎîîÏñ¥ÏãúÌã∞","ÏõîÎìúÏªµÍ≤ΩÍ∏∞Ïû•","ÎßàÌè¨Íµ¨Ï≤≠","ÎßùÏõê","Ìï©Ï†ï","ÏÉÅÏàò","Í¥ëÌù•Ï∞Ω","ÎåÄÌù•","Í≥µÎçï","Ìö®Ï∞ΩÍ≥µÏõêÏïû","ÏÇºÍ∞ÅÏßÄ","ÎÖπÏÇ¨Ìèâ","Ïù¥ÌÉúÏõê","ÌïúÍ∞ïÏßÑ","Î≤ÑÌã∞Í≥†Í∞ú","ÏïΩÏàò","Ï≤≠Íµ¨","Ïã†Îãπ","ÎèôÎ¨òÏïû","Ï∞ΩÏã†","Î≥¥Î¨∏","ÏïàÏïî","Í≥†Î†§ÎåÄ","ÏõîÍ≥°","ÏÉÅÏõîÍ≥°","ÎèåÍ≥∂Ïù¥","ÏÑùÍ≥Ñ","ÌÉúÎ¶âÏûÖÍµ¨","ÌôîÎûëÎåÄ","Î¥âÌôîÏÇ∞","Ïã†ÎÇ¥"],"7Ìò∏ÏÑ†":["Ïû•Ïïî","ÎèÑÎ¥âÏÇ∞","ÏàòÎùΩÏÇ∞","ÎßàÎì§","ÎÖ∏Ïõê","Ï§ëÍ≥Ñ","ÌïòÍ≥Ñ","Í≥µÎ¶â","ÌÉúÎ¶âÏûÖÍµ¨","Î®πÍ≥®","Ï§ëÌôî","ÏÉÅÎ¥â","Î©¥Î™©","ÏÇ¨Í∞ÄÏ†ï","Ïö©ÎßàÏÇ∞","Ï§ëÍ≥°","Íµ∞Ïûê","Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê","Í±¥ÎåÄÏûÖÍµ¨","ÎöùÏÑ¨Ïú†ÏõêÏßÄ","Ï≤≠Îã¥","Í∞ïÎÇ®Íµ¨Ï≤≠","ÌïôÎèô","ÎÖºÌòÑ","Î∞òÌè¨","Í≥†ÏÜçÌÑ∞ÎØ∏ÎÑê","ÎÇ¥Î∞©","Ïù¥Ïàò","ÎÇ®ÏÑ±","Ïà≠Ïã§ÎåÄÏûÖÍµ¨","ÏÉÅÎèÑ","Ïû•ÏäπÎ∞∞Í∏∞","Ïã†ÎåÄÎ∞©ÏÇºÍ±∞Î¶¨","Î≥¥ÎùºÎß§","Ïã†Ìíç","ÎåÄÎ¶º","ÎÇ®Íµ¨Î°ú","Í∞ÄÏÇ∞ÎîîÏßÄÌÑ∏Îã®ÏßÄ","Ï≤†ÏÇ∞","Í¥ëÎ™ÖÏÇ¨Í±∞Î¶¨","Ï≤úÏôï","Ïò®Ïàò","ÍπåÏπòÏö∏","Î∂ÄÏ≤úÏ¢ÖÌï©Ïö¥ÎèôÏû•","Ï∂òÏùò","Ïã†Ï§ëÎèô","Î∂ÄÏ≤úÏãúÏ≤≠","ÏÉÅÎèô","ÏÇºÏÇ∞Ï≤¥Ïú°Í¥Ä","Íµ¥Ìè¨Ï≤ú","Î∂ÄÌèâÍµ¨Ï≤≠","ÏÉÅÍ∞à","ÏÇ∞Í≥°","ÏÑùÎÇ®"],"8Ìò∏ÏÑ†":["Î≥ÑÎÇ¥","Îã§ÏÇ∞","ÎèôÍµ¨Î¶â","Íµ¨Î¶¨","Ïû•ÏûêÌò∏ÏàòÍ≥µÏõê","ÏïîÏÇ¨Ïó≠ÏÇ¨Í≥µÏõê","ÏïîÏÇ¨","Ï≤úÌò∏","Í∞ïÎèôÍµ¨Ï≤≠","Î™ΩÏ¥åÌÜ†ÏÑ±","Ïû†Ïã§","ÏÑùÏ¥å","ÏÜ°Ìåå","Í∞ÄÎùΩÏãúÏû•","Î¨∏Ï†ï","Ïû•ÏßÄ","Î≥µÏ†ï","ÎÇ®ÏúÑÎ°Ä","ÏÇ∞ÏÑ±","ÎÇ®ÌïúÏÇ∞ÏÑ±ÏûÖÍµ¨","Îã®ÎåÄÏò§Í±∞Î¶¨","Ïã†Ìù•","ÏàòÏßÑ","Î™®ÎûÄ"],"9Ìò∏ÏÑ†":["Í∞úÌôî","ÍπÄÌè¨Í≥µÌï≠","Í≥µÌï≠ÏãúÏû•","Ïã†Î∞©Ìôî","ÎßàÍ≥°ÎÇòÎ£®","ÏñëÏ≤úÌñ•Íµê","Í∞ÄÏñë","Ï¶ùÎØ∏","Îì±Ï¥å","ÏóºÏ∞Ω","Ïã†Î™©Îèô","ÏÑ†Ïú†ÎèÑ","ÎãπÏÇ∞","Íµ≠ÌöåÏùòÏÇ¨Îãπ","Ïó¨ÏùòÎèÑ","ÏÉõÍ∞ï","ÎÖ∏ÎüâÏßÑ","ÎÖ∏Îì§","ÌùëÏÑù","ÎèôÏûë","Íµ¨Î∞òÌè¨","Ïã†Î∞òÌè¨","Í≥†ÏÜçÌÑ∞ÎØ∏ÎÑê","ÏÇ¨Ìèâ","Ïã†ÎÖºÌòÑ","Ïñ∏Ï£º","ÏÑ†Ï†ïÎ¶â","ÏÇºÏÑ±Ï§ëÏïô","Î¥âÏùÄÏÇ¨","Ï¢ÖÌï©Ïö¥ÎèôÏû•","ÏÇºÏ†Ñ","ÏÑùÏ¥åÍ≥†Î∂Ñ","ÏÑùÏ¥å","ÏÜ°ÌååÎÇòÎ£®","ÌïúÏÑ±Î∞±Ï†ú","Ïò¨Î¶ºÌîΩÍ≥µÏõê","ÎëîÏ¥åÏò§Î•ú","Ï§ëÏïôÎ≥¥ÌõàÎ≥ëÏõê"],"Í≤ΩÏùòÏ§ëÏïôÏÑ†":["Î¨∏ÏÇ∞","ÌååÏ£º","ÏõîÎ°±","Í∏àÏ¥å","Í∏àÎ¶â","Ïö¥Ï†ï","ÏïºÎãπ","ÌÉÑÌòÑ","ÏùºÏÇ∞","ÌíçÏÇ∞","Î∞±Îßà","Í≥°ÏÇ∞","ÎåÄÍ≥°","Îä•Í≥°","ÌñâÏã†","Í∞ïÎß§","ÌôîÏ†Ñ","ÏàòÏÉâ","ÎîîÏßÄÌÑ∏ÎØ∏ÎîîÏñ¥ÏãúÌã∞","Í∞ÄÏ¢å","ÌôçÎåÄÏûÖÍµ¨","ÏÑúÍ∞ïÎåÄ","Í≥µÎçï","Ìö®Ï∞ΩÍ≥µÏõêÏïû","Ïö©ÏÇ∞","Ïù¥Ï¥å","ÏÑúÎπôÍ≥†","ÌïúÎÇ®","Ïò•Ïàò","ÏùëÎ¥â","ÏôïÏã≠Î¶¨","Ï≤≠ÎüâÎ¶¨","ÌöåÍ∏∞","Ï§ëÎûë","ÏÉÅÎ¥â","ÎßùÏö∞","ÏñëÏõê","Íµ¨Î¶¨","ÎèÑÎÜç","ÏñëÏ†ï","ÎçïÏÜå","ÎèÑÏã¨","ÌåîÎãπ","Ïö¥Í∏∏ÏÇ∞","ÏñëÏàò","Ïã†Ïõê","Íµ≠Ïàò","ÏïÑÏã†","Ïò§Îπà","ÏñëÌèâ","ÏõêÎçï","Ïö©Î¨∏","ÏßÄÌèâ"],"Ïã†Î∂ÑÎãπÏÑ†":["Ïã†ÏÇ¨","ÎÖºÌòÑ","Ïã†ÎÖºÌòÑ","Í∞ïÎÇ®","ÏñëÏû¨","ÏñëÏû¨ÏãúÎØºÏùòÏà≤","Ï≤≠Í≥ÑÏÇ∞ÏûÖÍµ¨","ÌåêÍµê","Ï†ïÏûê","ÎØ∏Í∏à","ÎèôÏ≤ú","ÏàòÏßÄÍµ¨Ï≤≠","ÏÑ±Î≥µ","ÏÉÅÌòÑ","Í¥ëÍµêÏ§ëÏïô","Í¥ëÍµê"],"ÏàòÏù∏Î∂ÑÎãπÏÑ†":["Ï≤≠ÎüâÎ¶¨","ÌöåÍ∏∞","Ï§ëÎûë","ÏÉÅÎ¥â","ÎßùÏö∞","Íµ¨Î¶¨","ÎèÑÎÜç","ÏñëÏ†ï","ÎçïÏÜå","ÏôïÏã≠Î¶¨","ÏÑúÏö∏Ïà≤","ÏïïÍµ¨Ï†ïÎ°úÎç∞Ïò§","Í∞ïÎÇ®Íµ¨Ï≤≠","ÏÑ†Ï†ïÎ¶â","ÏÑ†Î¶â","ÌïúÌã∞","ÎèÑÍ≥°","Íµ¨Î£°","Í∞úÌè¨Îèô","ÎåÄÎ™®ÏÇ∞ÏûÖÍµ¨","ÏàòÏÑú","Î≥µÏ†ï","Í∞ÄÏ≤úÎåÄ","ÌÉúÌèâ","Î™®ÎûÄ","ÏïºÌÉë","Ïù¥Îß§","ÏÑúÌòÑ","ÏàòÎÇ¥","Ï†ïÏûê","ÎØ∏Í∏à","Ïò§Î¶¨","Ï£ΩÏ†Ñ","Î≥¥Ï†ï","Íµ¨ÏÑ±","Ïã†Í∞à","Í∏∞Ìù•","ÏÉÅÍ∞à","Ï≤≠Î™Ö","ÏòÅÌÜµ","ÎßùÌè¨","Îß§ÌÉÑÍ∂åÏÑ†","ÏàòÏõêÏãúÏ≤≠","Îß§Íµê","ÏàòÏõê","Í≥†ÏÉâ","Ïò§Î™©Ï≤ú","Ïñ¥Ï≤ú","ÏïºÎ™©","ÏÇ¨Î¶¨","ÌïúÎåÄÏïû","Ï§ëÏïô","Í≥†Ïûî","Ï¥àÏßÄ","ÏïàÏÇ∞","Ïã†Í∏∏Ïò®Ï≤ú","Ï†ïÏôï","Ïò§Ïù¥ÎèÑ","Îã¨Ïõî","ÏõîÍ≥∂","ÏÜåÎûòÌè¨Íµ¨","Ïù∏Ï≤úÎÖºÌòÑ","Ìò∏Íµ¨Ìè¨","ÎÇ®ÎèôÏù∏ÎçîÏä§ÌååÌÅ¨","ÏõêÏù∏Ïû¨","Ïó∞Ïàò","ÏÜ°ÎèÑ","ÌïôÏùµ","Ïù∏ÌïòÎåÄ","Ïà≠Ïùò","Ïã†Ìè¨","Ïù∏Ï≤ú"]};

  // Audio: NO BGM, only SFX
  let audioCtx=null, sfxGain=null;
  function ensureAudio(){
    if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
    if(!sfxGain){ sfxGain = audioCtx.createGain(); sfxGain.gain.value=0.18; sfxGain.connect(audioCtx.destination); }
  }
  function startBGM(){ ensureAudio(); }
  function playTick(){
    ensureAudio();
    const now=audioCtx.currentTime;
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    const f=audioCtx.createBiquadFilter();
    o.type='square'; o.frequency.value=1500;
    f.type='bandpass'; f.frequency.value=1100; f.Q.value=9;
    g.gain.value=0.0001;
    o.connect(f).connect(g).connect(sfxGain);
    o.start(now);
    g.gain.linearRampToValueAtTime(0.18, now+0.004);
    g.gain.exponentialRampToValueAtTime(0.0001, now+0.06);
    o.stop(now+0.07);
    const o2=audioCtx.createOscillator();
    const g2=audioCtx.createGain();
    o2.type='sine'; o2.frequency.value=420;
    g2.gain.value=0.0001;
    o2.connect(g2).connect(sfxGain);
    o2.start(now+0.018);
    g2.gain.linearRampToValueAtTime(0.07, now+0.03);
    g2.gain.exponentialRampToValueAtTime(0.0001, now+0.16);
    o2.stop(now+0.17);
  }
  function playDing(){
    ensureAudio();
    const now=audioCtx.currentTime;
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    o.type='sine'; o.frequency.value=880;
    g.gain.value=0.0001;
    o.connect(g).connect(sfxGain);
    o.start(now);
    g.gain.linearRampToValueAtTime(0.14, now+0.02);
    o.frequency.linearRampToValueAtTime(1175, now+0.14);
    g.gain.exponentialRampToValueAtTime(0.0001, now+0.42);
    o.stop(now+0.43);
  }
  function playFanfare(){
    ensureAudio();
    const now=audioCtx.currentTime;
    const g=audioCtx.createGain();
    g.gain.value=0.0001;
    g.connect(sfxGain);
    const o1=audioCtx.createOscillator();
    const o2=audioCtx.createOscillator();
    o1.type='square'; o2.type='square';
    o1.connect(g); o2.connect(g);
    const seq=[523.25,659.25,783.99,1046.5];
    const dur=0.10;
    o1.start(now); o2.start(now);
    seq.forEach((f,i)=>{ o1.frequency.setValueAtTime(f, now+i*dur); o2.frequency.setValueAtTime(f*0.5, now+i*dur); });
    g.gain.linearRampToValueAtTime(0.18, now+0.02);
    g.gain.linearRampToValueAtTime(0.12, now+0.18);
    g.gain.exponentialRampToValueAtTime(0.0001, now+seq.length*dur+0.12);
    o1.stop(now+seq.length*dur+0.15);
    o2.stop(now+seq.length*dur+0.15);
  }
  function formatStation(s){ s=String(s).trim().replace(/Ïó≠$/,''); return s+'Ïó≠'; }
  function normalizeName(s){ return String(s).trim().replace(/Ïó≠$/,'').replace(/\s+/g,''); }

  // Build line data (line-aware)
  function cleanLine(arr){
    const out=[];
    for(let i=0;i<arr.length;i++){ 
      const s=String(arr[i]).trim(); 
      if(!s) continue;
      if(out.length && out[out.length-1]===s) continue;
      out.push(s);
    }
    return out;
  }
  const subwayData={};
  const lineNames=Object.keys(DATA);
  for(const line of lineNames) subwayData[line]=cleanLine(DATA[line]);

  const lineIndex={};
  for(const line of lineNames){
    lineIndex[line]={};
    const arr=subwayData[line];
    for(let i=0;i<arr.length;i++) lineIndex[line][arr[i]]=i;
  }
  const stationLines=new Map();
  for(const line of lineNames){
    for(const st of subwayData[line]){
      if(!stationLines.has(st)) stationLines.set(st,new Set());
      stationLines.get(st).add(line);
    }
  }
  const getLinesOf=(st)=>stationLines.get(st)?Array.from(stationLines.get(st)):[];
  const getNextOnLine=(line,st,dir)=>{
    const idx=lineIndex[line][st];
    if(idx===undefined) return null;
    const arr=subwayData[line];
    const ni=idx+dir;
    if(ni<0||ni>=arr.length) return null;
    return arr[ni];
  };
  const allStations=Array.from(stationLines.keys());

  // Layout (no x-averaging)
  const yStep=90, xStep=22, marginX=90, marginY=90;
  const pos=new Map();
  for(let li=0; li<lineNames.length; li++){
    const line=lineNames[li];
    const y=marginY + li*yStep;
    const arr=subwayData[line];
    for(let i=0;i<arr.length;i++){
      const st=arr[i];
      const x=marginX + i*xStep;
      pos.set(line+'::'+st, {x:x,y:y});
    }
  }

  // Draw SVG
  const viewport=document.getElementById('viewport');
  const map=document.getElementById('map');
  const gLines=document.getElementById('gLines');
  const gDots=document.getElementById('gDots');
  const token=document.getElementById('token');
  const hudG=document.getElementById('hudG');
  const hudLine1=document.getElementById('hudLine1');
  const hudLine2=document.getElementById('hudLine2');

  const LINE_COLORS={"1Ìò∏ÏÑ†":"#1e88e5","2Ìò∏ÏÑ†":"#2e7d32","3Ìò∏ÏÑ†":"#f9a825","4Ìò∏ÏÑ†":"#039be5","5Ìò∏ÏÑ†":"#8e24aa","6Ìò∏ÏÑ†":"#6d4c41","7Ìò∏ÏÑ†":"#7b1fa2","8Ìò∏ÏÑ†":"#d81b60","9Ìò∏ÏÑ†":"#b59a00","Í≤ΩÏùòÏ§ëÏïôÏÑ†":"#00838f","Ïã†Î∂ÑÎãπÏÑ†":"#c62828","ÏàòÏù∏Î∂ÑÎãπÏÑ†":"#f06292"};
  const lineColor=(n)=>LINE_COLORS[n]||"#ff4d6d";
  function svgEl(tag, attrs){ 
    const el=document.createElementNS('http://www.w3.org/2000/svg', tag);
    for(const k in attrs) el.setAttribute(k, attrs[k]);
    return el;
  }

  let maxLen=0;
  for(const line of lineNames) maxLen=Math.max(maxLen, subwayData[line].length);
  const W=Math.max(1800, marginX + maxLen*xStep + 140);
  const H=Math.max(1100, marginY + lineNames.length*yStep + 140);
  map.setAttribute('width', String(W));
  map.setAttribute('height', String(H));
  map.setAttribute('viewBox', '0 0 '+W+' '+H);

  for(let li=0; li<lineNames.length; li++){
    const line=lineNames[li];
    const arr=subwayData[line];
    let d='';
    for(let i=0;i<arr.length;i++){
      const p=pos.get(line+'::'+arr[i]);
      d += (i===0 ? ('M '+p.x+' '+p.y) : (' L '+p.x+' '+p.y));
    }
    gLines.appendChild(svgEl('path', {d:d, class:'lineStroke', stroke: lineColor(line)}));
    gLines.appendChild(svgEl('path', {d:d, class:'lineInner'}));
    const label=svgEl('text', {x:'16', y:String(marginY + li*yStep + 5), class:'label'});
    label.textContent=line;
    gLines.appendChild(label);
  }

  stationLines.forEach((set, st)=>{
    const lines=Array.from(set);
    if(lines.length<2) return;
    const pts=[];
    for(const l of lines){ const p=pos.get(l+'::'+st); if(p) pts.push(p); }
    pts.sort((a,b)=>a.y-b.y);
    if(pts.length<2) return;
    let d='M '+pts[0].x+' '+pts[0].y;
    for(let i=1;i<pts.length;i++) d += ' L '+pts[i].x+' '+pts[i].y;
    gLines.appendChild(svgEl('path', {d:d, class:'connector'}));
  });

  // show interchange dots
  stationLines.forEach((set, st)=>{
    if(set.size<2) return;
    for(const line of set){ 
      const p=pos.get(line+'::'+st);
      if(!p) continue;
      gDots.appendChild(svgEl('circle', {cx:String(p.x), cy:String(p.y), r:'4', class:'stationDot'}));
    }
  });

  // Drag-to-pan
  (function enableDragPan(){
    let isDown=false, startX=0, startY=0, sl=0, st=0;
    viewport.addEventListener('pointerdown',(e)=>{
      isDown=true; viewport.setPointerCapture(e.pointerId);
      startX=e.clientX; startY=e.clientY;
      sl=viewport.scrollLeft; st=viewport.scrollTop;
    });
    viewport.addEventListener('pointermove',(e)=>{
      if(!isDown) return;
      viewport.scrollLeft = sl - (e.clientX - startX);
      viewport.scrollTop  = st - (e.clientY - startY);
    });
    viewport.addEventListener('pointerup',()=>{ isDown=false; });
    viewport.addEventListener('pointercancel',()=>{ isDown=false; });
  })();

  // Confetti
  const confCanvas=document.getElementById('confetti');
  const confCtx=confCanvas.getContext('2d');
  function resizeCanvasTo(el, canvas, ctx){
    const r=el.getBoundingClientRect();
    const dpr=window.devicePixelRatio||1;
    canvas.width=Math.floor(r.width*dpr);
    canvas.height=Math.floor(r.height*dpr);
    canvas.style.width=r.width+'px';
    canvas.style.height=r.height+'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
    return {w:r.width,h:r.height};
  }
  function burstConfettiOn(canvas, ctx, w, h){
    if(canvas.__raf) cancelAnimationFrame(canvas.__raf);
    const colors=["#ff4d6d","#ff85a2","#ffd6e0","#c9184a","#ffb3c1","#ffe3ea"];
    const pieces=[];
    const count=190;
    for(let i=0;i<count;i++) pieces.push({x:w*0.5,y:h*0.32,vx:(Math.random()-0.5)*9,vy:-Math.random()*11-7,g:0.22+Math.random()*0.18,w:4+Math.random()*5,h:3+Math.random()*5,a:Math.random()*Math.PI,va:(Math.random()-0.5)*0.25,c:colors[Math.floor(Math.random()*colors.length)],life:0,max:170+Math.random()*70});
    function tick(){
      ctx.clearRect(0,0,w,h);
      let alive=0;
      for(const p of pieces){
        p.life++; if(p.life<p.max) alive++;
        p.vy+=p.g; p.x+=p.vx; p.y+=p.vy; p.a+=p.va;
        ctx.save();
        ctx.translate(p.x,p.y);
        ctx.rotate(p.a);
        ctx.globalAlpha=Math.max(0,1-p.life/p.max);
        ctx.fillStyle=p.c;
        ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
        ctx.restore();
      }
      ctx.globalAlpha=1;
      if(alive>0) canvas.__raf=requestAnimationFrame(tick);
      else ctx.clearRect(0,0,w,h);
    }
    tick();
  }
  resizeCanvasTo(viewport, confCanvas, confCtx);
  window.addEventListener('resize', ()=>{ resizeCanvasTo(viewport, confCanvas, confCtx); });

  // Movement helpers
  function setTokenXY(x,y, smooth){
    token.setAttribute('transform','translate('+x+','+y+')');
    hudG.setAttribute('transform','translate('+x+','+y+')');
    if(smooth){
      viewport.scrollTo({left:Math.max(0,x-viewport.clientWidth/2), top:Math.max(0,y-viewport.clientHeight/2), behavior:'smooth'});
    }
  }
  function setTokenAt(line, st, smooth){
    const p=pos.get(line+'::'+st);
    if(!p) return;
    setTokenXY(p.x,p.y,smooth);
  }
  function dist(a,b){ const dx=a.x-b.x, dy=a.y-b.y; return Math.sqrt(dx*dx+dy*dy); }
  function moveSegment(lineA, stA, lineB, stB){
    const a=pos.get(lineA+'::'+stA);
    const b=pos.get(lineB+'::'+stB);
    if(!a||!b) return Promise.resolve();
    const d=dist(a,b);
    const duration=Math.max(240, Math.min(650, d*6.5));
    const start=performance.now();
    return new Promise(res=>{
      function tick(t){
        const p=Math.min(1,(t-start)/duration);
        const e=p<0.5?4*p*p*p:1-Math.pow(-2*p+2,3)/2;
        setTokenXY(a.x+(b.x-a.x)*e, a.y+(b.y-a.y)*e, true);
        if(p<1) requestAnimationFrame(tick); else res();
      }
      requestAnimationFrame(tick);
    });
  }

  // Path generator: transfer only at interchange, stop at terminal, no reverse
  const MAX_STOPS=25;
  function randomWalkPath(startLine, startStation){
    let curLine=startLine;
    let dir=Math.random()<0.5?-1:1;
    const stepsPlanned=randInt(1,MAX_STOPS);
    const path=[{line:curLine, st:startStation}];
    let prevSt=null, curSt=startStation;
    for(let step=1; step<=stepsPlanned; step++){
      const linesAtCur=getLinesOf(curSt);
      if(linesAtCur.length>=2){
        const remain=stepsPlanned-step+1;
        const nearEnd=remain<=6;
        const pTransfer=nearEnd?0.55:0.22;
        if(Math.random()<pTransfer){
          const choices=linesAtCur.filter(l=>l!==curLine);
          if(choices.length) curLine=pick(choices);
        }
      }
      const nextSt=getNextOnLine(curLine,curSt,dir);
      if(!nextSt) break;
      if(prevSt && nextSt===prevSt) break;
      prevSt=curSt; curSt=nextSt;
      path.push({line:curLine, st:curSt});
    }
    return path;
  }

  // Result overlay
  const overlay=document.getElementById('resultOverlay');
  const resultStation=document.getElementById('resultStation');
  const resultCount=document.getElementById('resultCount');
  const resultBox=document.getElementById('resultBox');
  const resultCanvas=document.getElementById('resultCanvas');
  const resultCtx=resultCanvas.getContext('2d');
  document.getElementById('closeBtn').addEventListener('click', ()=>{ overlay.style.display='none'; });
  function showResultOverlay(stationName,totalMoved){
    resultStation.textContent = formatStation(stationName);
    resultCount.textContent = 'Ï¥ù ' + totalMoved + 'Ï†ïÍ±∞Ïû• Ïù¥Îèô';
    overlay.style.display='flex';
    const dims = resizeCanvasTo(resultBox, resultCanvas, resultCtx);
    burstConfettiOn(resultCanvas, resultCtx, dims.w, dims.h);
    playFanfare();
  }

  // Init
  const startInput=document.getElementById('startInput');
  const goBtn=document.getElementById('goBtn');
  let currentStation = allStations.includes('ÌôîÏ†ï') ? 'ÌôîÏ†ï' : (allStations[0] || 'ÏãúÏ≤≠');
  let currentLine = getLinesOf(currentStation)[0] || lineNames[0];
  startInput.value=currentStation;
  setTokenAt(currentLine,currentStation,true);
  hudLine1.textContent=formatStation(currentStation);
  hudLine2.textContent='Ïù¥Îèô: 0Ï†ïÍ±∞Ïû•';
  let animating=false;

  function findStartStation(input){
    const q=normalizeName(input);
    for(const s of allStations) if(normalizeName(s)===q) return s;
    return null;
  }

  async function animatePath(path){
    let moved=0;
    for(let i=0;i<path.length;i++){
      const cur=path[i];
      hudLine1.textContent=formatStation(cur.st);
      hudLine2.textContent='Ïù¥Îèô: '+moved+'Ï†ïÍ±∞Ïû•';
      if(i===0){ setTokenAt(cur.line,cur.st,true); await sleep(280); continue; }
      const prev=path[i-1];
      await moveSegment(prev.line,prev.st,cur.line,cur.st);
      moved++;
      hudLine2.textContent='Ïù¥Îèô: '+moved+'Ï†ïÍ±∞Ïû•';
      playTick();
      await sleep(160);
      const remain=(path.length-1)-i;
      const t=Math.max(0,6-remain);
      const jitter=Math.floor(Math.random()*180);
      const curve=t===0 ? 1 : (1 + 0.14*t*t);
      let ms=(380 + jitter)*curve;
      if(remain<=2) ms += 260;
      await sleep(ms);
    }
    return moved;
  }

  async function finale(targetStation,totalMoved){
    playDing();
    const dims = resizeCanvasTo(viewport, confCanvas, confCtx);
    burstConfettiOn(confCanvas, confCtx, dims.w, dims.h);
    showResultOverlay(targetStation,totalMoved);
  }

  async function onStart(){
    if(animating) return;
    const startStation=findStartStation(startInput.value);
    if(!startStation){ showErr('Ï∂úÎ∞úÏó≠ Ïò§ÌÉÄ! Ïòà: ÌòúÌôî, ÎèôÎåÄÎ¨∏, ÌôîÏ†ï, Í∞ïÎÇ®'); return; }
    animating=true; goBtn.disabled=true;
    startBGM();
    overlay.style.display='none';
    currentStation=startStation;
    currentLine=getLinesOf(currentStation)[0] || lineNames[0];
    const path=randomWalkPath(currentLine,currentStation);
    const last=path[path.length-1];
    const moved=await animatePath(path);
    await finale(last.st,moved);
    currentStation=last.st;
    currentLine=last.line;
    animating=false; goBtn.disabled=false;
  }

  goBtn.addEventListener('click', onStart);
  goBtn.addEventListener('touchend', (e)=>{ e.preventDefault(); onStart(); }, {passive:false});
})();
</script>
</body>
</html>
